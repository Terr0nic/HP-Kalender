<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Theorie-Unterricht â€“ Kalender</title>

<style>
:root{
  --bg:#f6f7fb;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --border:#e5e7eb;
  --shadow:0 14px 40px rgba(2,6,23,.10);
  --radius:18px;
  --accent:#2563eb;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:1280px;margin:26px auto;padding:0 16px}
h1{margin:0 0 14px;font-size:24px;font-weight:950}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
  position:relative;
}
.card::before{
  content:"";
  position:absolute;left:0;top:0;right:0;height:6px;
  background:var(--accent);
}

button{
  border:1px solid var(--border);
  background:#fff;
  font-weight:900;
  border-radius:14px;
  padding:9px 12px;
  cursor:pointer;
}
button:hover{border-color:var(--accent)}

.branchBar{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}
.bbtn{
  display:inline-flex;align-items:center;gap:6px;
  border-radius:999px;padding:8px 12px;
  border:1px solid var(--border);
}
.bbtn.active{background:#111827;color:#fff;border-color:#111827}
.dot{width:9px;height:9px;border-radius:999px;display:inline-block}

.navRow{display:flex;gap:10px;align-items:center;margin-bottom:10px}
.iconBtn{width:38px;height:38px;border-radius:999px}
.monthTitle{font-weight:950;min-width:160px;text-align:center}

.todayBtn{
  background:var(--accent);
  color:#fff;
  border-color:transparent;
  border-radius:999px;
}

.nextBar{
  border:1px solid var(--border);
  border-radius:14px;
  padding:10px 12px;
  margin-bottom:14px;
  background:#fff;
}
.nextBar strong{font-size:14px}

table.cal{width:100%;border-collapse:separate;border-spacing:8px}
.cal th{font-size:12px;text-align:left;color:#475569}
.day{
  border:1px solid var(--border);
  border-radius:14px;
  padding:8px;
  min-height:95px;
  vertical-align:top;
  background:#fff;
}
.day.out{opacity:.3}
.day.past{opacity:.45}
.day.today{outline:2px solid rgba(37,99,235,.25)}

.dateLine{
  display:flex;justify-content:space-between;
  font-size:12px;font-weight:900;color:#334155;margin-bottom:6px
}

.pill{
  border:1px solid rgba(0,0,0,.06);
  border-radius:12px;
  padding:6px 8px;
  font-size:11.5px;
  margin-top:6px;
  background:#f9fafb;
  cursor:pointer;
}
.pill.hafen{background:rgba(245,158,11,.15)}
.pill.off{background:rgba(239,68,68,.12)}
.pill.holiday{background:#eef2f7;font-style:italic}

.list{margin-top:18px;border-top:1px solid var(--border);padding-top:14px}
.item{
  border:1px solid var(--border);
  border-radius:14px;
  padding:10px 12px;
  background:#fff;
  margin-top:10px;
  cursor:pointer;
}
.when{font-weight:950}
.small{font-size:12px;color:var(--muted)}

</style>
</head>
<body>
<div class="wrap">
<h1>ðŸš¦ Theorie-Unterricht</h1>

<div class="card">

<div class="branchBar" id="branchBar"></div>

<div class="navRow">
  <button class="iconBtn" id="prevMonth">â€¹</button>
  <div class="monthTitle" id="monthTitle"></div>
  <button class="iconBtn" id="nextMonth">â€º</button>
  <button class="todayBtn" id="goToday">Heute</button>
</div>

<div class="nextBar">
  <strong id="nextText">NÃ¤chster Termin: â€”</strong>
</div>

<table class="cal">
<thead>
<tr><th>Mo</th><th>Di</th><th>Mi</th><th>Do</th><th>Fr</th><th>Sa</th><th>So</th></tr>
</thead>
<tbody id="calBody"></tbody>
</table>

<div class="list" id="listWrap"></div>

</div>
</div>

<script>
/* ======================
   KONFIGURATION
====================== */
const CONFIG = {
  anchors: {
    hemshof:    { date: "2026-01-20", lessonNo: 2 },
    innenstadt: { date: "2026-01-19", lessonNo: 1 },
    seckenheim: { date: "2026-01-20", lessonNo: 9 }
  },
  closures: {
    hemshof: ["2026-02-03"],   // ðŸ‘ˆ Ausfall Thema 5 (Hemshof)
    innenstadt: [],
    seckenheim: [],
    hafen: []
  }
};

const TOPICS = [
"PersÃ¶nliche Voraussetzungen",
"Rechtliche Rahmenbedingungen",
"Grundregeln",
"StraÃŸenverkehrssystem",
"Vorfahrt / Vorrang",
"Verkehrsregelungen",
"Geschwindigkeit / Abstand",
"Andere Teilnehmer",
"FahrmanÃ¶ver",
"Ruhender Verkehr",
"Besondere Situationen",
"Lebenslanges Lernen",
"Technik",
"Fahren mit ZÃ¼gen"
];

const BRANCHES = [
{ id:"innenstadt", name:"Innenstadt", iso:[1,3], color:"#2563eb" },
{ id:"seckenheim", name:"Seckenheim", iso:[2,4], color:"#16a34a" },
{ id:"hemshof", name:"Hemshof", iso:[2,4], color:"#0891b2" },
{ id:"hafen", name:"Hafen", iso:[3], color:"#f59e0b", type:"HAFEN" }
];

const $=id=>document.getElementById(id);
let currentBranch="innenstadt";
let currentMonth=new Date(new Date().getFullYear(),new Date().getMonth(),1);

function pad(n){return String(n).padStart(2,"0")}
function iso(d){return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`}
function add(d,n){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+n)}
function jsIso(d){return d===0?7:d}

function buildBranchButtons(){
  $("branchBar").innerHTML="";
  BRANCHES.forEach(b=>{
    const btn=document.createElement("button");
    btn.className="bbtn";
    btn.dataset.id=b.id;
    btn.innerHTML=`<span class="dot" style="background:${b.color}"></span>${b.name}`;
    btn.onclick=()=>{currentBranch=b.id;highlight();render();}
    $("branchBar").appendChild(btn);
  });
}
function highlight(){
  [...document.querySelectorAll(".bbtn")].forEach(b=>{
    b.classList.toggle("active",b.dataset.id===currentBranch);
  });
}

function buildSchedule(){
  const b=BRANCHES.find(x=>x.id===currentBranch);
  const anchor=CONFIG.anchors[currentBranch];
  const closures=new Set(CONFIG.closures[currentBranch]||[]);
  let topicIndex=anchor.lessonNo-1;
  let d=new Date(anchor.date);
  const events=[];
  for(let i=0;i<600;i++){
    if(b.iso.includes(jsIso(d.getDay()))){
      const dIso=iso(d);
      if(!closures.has(dIso)){
        if(b.type==="HAFEN"){
          events.push({date:dIso,title:"ðŸš› LKW/BUS"});
        } else {
          events.push({date:dIso,title:`THEMA ${topicIndex+1}`,text:TOPICS[topicIndex]});
          topicIndex=(topicIndex+1)%TOPICS.length;
        }
      }
    }
    d=add(d,1);
  }
  return events;
}

function render(){
  highlight();
  const events=buildSchedule();
  const map=new Map();
  events.forEach(e=>{
    if(!map.has(e.date))map.set(e.date,[]);
    map.get(e.date).push(e);
  });

  $("monthTitle").textContent=currentMonth.toLocaleDateString("de-DE",{month:"long",year:"numeric"});
  const first=new Date(currentMonth.getFullYear(),currentMonth.getMonth(),1);
  const start=add(first,-(jsIso(first.getDay())-1));
  let d=start;
  $("calBody").innerHTML="";
  const today=iso(new Date());

  for(let w=0;w<6;w++){
    const tr=document.createElement("tr");
    for(let i=0;i<7;i++){
      const td=document.createElement("td");
      td.className="day";
      const dIso=iso(d);
      if(d.getMonth()!==currentMonth.getMonth()) td.classList.add("out");
      if(dIso<today) td.classList.add("past");
      if(dIso===today) td.classList.add("today");

      td.innerHTML=`<div class="dateLine"><span>${d.toLocaleDateString("de-DE",{weekday:"short"})}</span><span>${pad(d.getDate())}.${pad(d.getMonth()+1)}</span></div>`;

      if(map.has(dIso)){
        map.get(dIso).forEach(ev=>{
          const p=document.createElement("div");
          p.className="pill";
          p.innerHTML=`<strong>${ev.title}</strong><div>${ev.text||""}</div>`;
          td.appendChild(p);
        });
      }
      tr.appendChild(td);
      d=add(d,1);
    }
    $("calBody").appendChild(tr);
  }

  // next
  const next=events.find(e=>e.date>=today);
  $("nextText").textContent=next ? `NÃ¤chster Termin: ${next.date} â€“ ${next.title}` : "Keine Termine";

  // list
  $("listWrap").innerHTML="<h3>NÃ¤chste Termine</h3>";
  events.filter(e=>e.date>=today).slice(0,10).forEach(e=>{
    const div=document.createElement("div");
    div.className="item";
    div.innerHTML=`<div class="when">${e.date} â€“ ${e.title}</div><div class="small">${e.text||""}</div>`;
    $("listWrap").appendChild(div);
  });
}

$("prevMonth").onclick=()=>{currentMonth=new Date(currentMonth.getFullYear(),currentMonth.getMonth()-1,1);render()}
$("nextMonth").onclick=()=>{currentMonth=new Date(currentMonth.getFullYear(),currentMonth.getMonth()+1,1);render()}
$("goToday").onclick=()=>{const n=new Date();currentMonth=new Date(n.getFullYear(),n.getMonth(),1);render()}

buildBranchButtons();
render();
</script>
</body>
</html>
